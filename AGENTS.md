
# Краткое описание
Telegram‑бот на Go для создания отложенных публикаций. Архитектура: используется конечный автомат состояний (FSM) для UI‑логики Телеграма. Хранение — SQLite.

## Ключевые фичи:
Управление телеграм каналами: добавление / просмотр добавленных / выбор для публикаций / удаление 
Планирование постов с учётом часовых поясов пользователя
Инлайн‑клавиатуры, callback queries, редактирование и удаление сообщений

## Технологии: 
Язык: Go 1.23.2
Библиотека: tgbotapi "github.com/OvyFlash/telegram-bot-api",
База данных: "github.com/mattn/go-sqlite3"
Окружение: "github.com/joho/godotenv"

# Цель для агента (Codex)

Агент помогает: писать фичи, отвечать на вопросы по коду, чинить баги, предлагать PR‑ы, запускать тесты, обновлять документацию. Работает малыми инкрементами, каждый PR — одна логическая задача.

## Принципы
Относись бережно к приватным данным, береги их сохранность от публикации
Минимальные изменения, маленькие PR; 100% компиляция и прохождение тестов
Не меняй публичные контракты без обсуждения
Соблюдай правила времени/часовых поясов (см. ниже)
Если не уверен в постановке (>10%), добавь вопросы в начало PR‑описания

# Быстрый старт / команды
## Зависимости
make tidy

## Линт
make lint

## Запуск
make run

# Переменные окружения
TELEGRAM_BOT_TOKEN # токен телеграм бота
TELEGRAM_BOT_DEBUG_MOD # флаг запускать ли бот в дебаг режиме

# Карта репозитория (ориентир)
/                   # main для запуска бота
/bot/               # логика работы бота
    buttons/        # кнопки интерфейса бота
    data/           # структуры данных используемых ботом
    fsm/            # конечные состояния и переходы
    manager/        # отправка и удаление сообщений в чатах
    messages/       # сообщения для взаимодействия с пользователями бота
    receiver/       # обновление и чтение сообщений из чатов
    sheduler/       # планирование и отправка сообщений
/storage/           # логика работы хранилища
    storageDB/      # код конкретного хранилища использующего SQLite


# Время и часовые пояса (обязательно)
В базе данных все время хранится в UTC. Операции со временем и планирование публикаций так же производятся в UTC.
Для пользователя бота сохраняем его смещение от UTC (еще не реализовано) и после этого выводим информацию с учетом этого смещения.

# Логирование и наблюдаемость
Уровни: debug/info/warn/error
В логах не печатать токены и приватные данные
На каждую задачу — корреляционный request_id (если есть)

# Код‑стиль и качество
gofmt/goimports обязательно
Маленькие, самодостаточные PR с понятным описанием
Unit‑тесты для бизнес‑логики, интеграционные — для FSM и Telegram обвязки (с моками)

# Ограничения (не трогать без задачи)
Публичные интерфейсы Telegram‑слоя
Контракты FSM (имена состояний и их ответственностей)
Формат сохранения данных


Каждая задача = отдельный PR: описание, чек‑лист, скриншоты/логи запуска, покрытие тестами.

# Порядок работы агента (runbook)
+ Синхронизируй ветку от main.
+ Прочитай AGENTS.md и README.md.
+ Запусти локально: make run
+ Напиши код в одной зоне, прогони go test ./....
+ Обнови документацию (README.md, этот файл при необходимости).
+ Создай PR с мини‑изменениями и вопросами, если что‑то не ясно.

# Формат коммитов и PR
Сообщения коммитов: feat: …, fix: …, refactor: …, test: …
PR‑описание: цель, изменения, как тестировал, скрин/лог, риски